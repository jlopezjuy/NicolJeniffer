<!DOCTYPE html>
<html xmlns="http://www.w3c.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core">
<h:head>
</h:head>
<h:body>
	<p:layout fullPage="true">
		<p:layoutUnit position="north" size="50">

		</p:layoutUnit>
		<p:layoutUnit position="south" size="50">

		</p:layoutUnit>
		<p:layoutUnit position="west" size="10">

		</p:layoutUnit>
		<p:layoutUnit position="east" size="10">

		</p:layoutUnit>
		<p:layoutUnit position="center" header="Venta">
			<h:form id="ventaForm">

				<p:panelGrid id="comunPanelGrid" columns="2">
					<p:panelGrid id="productoPanelGrid" columns="2">
						<p:outputLabel value="Buscar Producto:" for="busquedaProducto"></p:outputLabel>
						<p:autoComplete id="busquedaProducto" value="#{ventaDiariaBean.productoSeleccionado}" completeMethod="#{ventaDiariaBean.sugerirProductos}" var="prodSugerido" itemValue="#{prodSugerido}"
							converter="productoConverter" minQueryLength="2" forceSelection="true">
							<p:column>
								<p:graphicImage value="/imagenes/ledAzul.png" width="30" height="30" />
							</p:column>
							<p:column style="text-align:right;">
								<p:outputLabel value="#{prodSugerido.codigo}">
								</p:outputLabel>
							</p:column>
							<p:column width="300">
								<p:outputLabel value="#{prodSugerido.nombre}"></p:outputLabel>
							</p:column>
							<p:column style="text-align:right;">
								<p:outputLabel value="#{prodSugerido.precioVenta}">
									<f:convertNumber currencySymbol="$" type="currency" locale="es" minFractionDigits="3" maxIntegerDigits="7" minIntegerDigits="1" />
								</p:outputLabel>
							</p:column>
							<p:ajax event="itemSelect" listener="#{ventaDiariaBean.agregarParaVenta}" update="productoDataTable,total,subTotal" />
						</p:autoComplete>
					</p:panelGrid>
					<p:panelGrid id="ventaPanelGrid" columns="4">
						<p:outputLabel value="Nombre:" for="nombreVenta"></p:outputLabel>
						<p:inputText id="nombreVenta" value="#{ventaDiariaBean.venta.nombre}"></p:inputText>

						<p:outputLabel value="Sub Total:"></p:outputLabel>
						<p:outputPanel style="background-color:yellow;text-align:right;">
							<p:outputLabel id="subTotal" value="#{ventaDiariaBean.venta.subTotalVenta}">
								<f:convertNumber currencySymbol="$" type="currency" locale="es" minFractionDigits="3" maxIntegerDigits="7" minIntegerDigits="1" />
							</p:outputLabel>
							<p:commandButton value="R" icon="ui-icon-refresh" disabled="true">

							</p:commandButton>
						</p:outputPanel>

						<p:outputLabel value="Fecha de Venta:" for="fechaVenta"></p:outputLabel>
						<p:calendar id="fechaVenta" value="#{ventaDiariaBean.venta.fechaVenta}" pattern="dd/MM/yyyy HH:mm" locale="es" navigator="true"></p:calendar>

						<p:outputLabel value="Descuento:" for="descuento"></p:outputLabel>
						<p:inputText id="descuento" value="#{ventaDiariaBean.venta.descuento}" valueChangeListener="#{ventaDiariaBean.cambioDescuento}" style="text-align:right;">
							<p:ajax update="total,subTotal"></p:ajax>
							<f:convertNumber type="number" locale="es" minFractionDigits="3" maxIntegerDigits="7" minIntegerDigits="1" />
						</p:inputText>

						<p:outputLabel value="Cliente:" for="cliente"></p:outputLabel>
						<p:selectOneMenu id="cliente" value="#{ventaDiariaBean.venta.idCliente}" style="width:220px">
							<f:selectItem itemLabel="Seleccionar..." itemValue="0" />
							<f:selectItems value="#{itemBean.clienteItems}" var="clienteItem" itemLabel="#{clienteItem.nombre}" itemValue="#{clienteItem.id}" />
						</p:selectOneMenu>

						<p:outputLabel value="Interes:" for="interes"></p:outputLabel>
						<p:inputText id="interes" value="#{ventaDiariaBean.venta.interes}" valueChangeListener="#{ventaDiariaBean.cambioInteres}" style="text-align:right;">
							<p:ajax update="total,subTotal"></p:ajax>
							<f:convertNumber type="number" locale="es" minFractionDigits="3" maxIntegerDigits="7" minIntegerDigits="1" />
						</p:inputText>

						<p:outputLabel value="Estado:" for="estadoVenta"></p:outputLabel>
						<p:selectOneMenu id="estadoVenta" value="#{ventaDiariaBean.venta.estado}" style="width:220px">
							<f:selectItems value="#{itemBean.estadosVentaItems}" var="estadoVentaItem" itemLabel="#{estadoVentaItem.nombre}" itemValue="#{estadoVentaItem.idItem}" />
						</p:selectOneMenu>

						<p:outputLabel value="Total:"></p:outputLabel>
						<p:outputPanel style="background-color:yellow;text-align:right;">
							<p:outputLabel id="total" value="#{ventaDiariaBean.venta.totalVenta}" title="#{ventaDiariaBean.gananciaVenta}">
								<f:convertNumber currencySymbol="$" type="currency" locale="es" minFractionDigits="3" maxIntegerDigits="7" minIntegerDigits="1" />
							</p:outputLabel>
							<p:commandButton value="R" icon="ui-icon-refresh">
								<p:ajax update="comunPanelGrid" listener="#{ventaDiariaBean.actualizarTotales}" />
							</p:commandButton>
						</p:outputPanel>

						<p:outputLabel></p:outputLabel>
						<p:commandButton value="Guardar Venta" actionListener="#{ventaDiariaBean.editarVenta}" rendered="#{ventaDiariaBean.modoEdicion}" action="ventaLista">
						</p:commandButton>

						<p:commandButton value="Vender" actionListener="#{ventaDiariaBean.vender}" rendered="#{ventaDiariaBean.modoNuevo}" action="ventaLista">
						</p:commandButton>

						<p:outputLabel></p:outputLabel>
						<p:outputPanel>
							<p:commandButton value="Re-iniciar" actionListener="#{ventaDiariaBean.agregarVenta}" update="productoDataTable" rendered="#{ventaDiariaBean.modoNuevo}">
							</p:commandButton>

							<p:commandButton value="Cancelar" actionListener="#{ventaDiariaBean.agregarVenta}" action="ventaLista" immediate="true">
							</p:commandButton>
						</p:outputPanel>
					</p:panelGrid>
				</p:panelGrid>

				<p:dataTable id="productoDataTable" value="#{ventaDiariaBean.venta.ventaItems}" var="producto">
					<f:facet name="header">
					Productos por Vender
					</f:facet>
					<p:column style="text-align:right;" width="150">
						<f:facet name="header">
					Cantidad
					</f:facet>
						<p:inputText value="#{producto.cantidad}" style="font-weight: bold; text-align:right;" size="11" title="Solo numeros desde 0,001 hasta 9.999.999,999">
							<p:ajax update="productoDataTable" listener="#{ventaDiariaBean.actualizarTotales}" />
						</p:inputText>
					</p:column>
					<p:column style="text-align:right;" width="200">
						<f:facet name="header">
					Codigo
					</f:facet>
						<h:outputText value="#{producto.codigo}" style="font-weight: bold;" />
					</p:column>
					<p:column>
						<f:facet name="header">
					Nombre
					</f:facet>
						<h:outputText value="#{producto.nombre}" style="font-weight: bold;" />
					</p:column>
					<p:column style="text-align:right;" width="200">
						<f:facet name="header">
					Precio Unitario
					</f:facet>
						<p:outputLabel value="#{producto.precioVenta}" style="font-weight: bold;">
							<f:convertNumber currencySymbol="$" type="currency" locale="es" minFractionDigits="3" maxIntegerDigits="7" minIntegerDigits="1" />
						</p:outputLabel>
					</p:column>
					<p:column style="text-align:right;" width="50">
						<p:commandButton value="X" action="#{ventaDiariaBean.quitarProducto}" update="productoDataTable">
							<f:setPropertyActionListener value="#{producto}" target="#{ventaDiariaBean.ventaItem}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>

			</h:form>
		</p:layoutUnit>
	</p:layout>

</h:body>
</html>

<!-- 
<h:form>             
    <h:panelGrid columns="2" cellpadding="5">
        <p:outputLabel for="ignored" value="Required" />
        <p:inputText id="ignored" required="true" />
    </h:panelGrid>
 
    <p:fragment autoUpdate="true">
        <h:panelGrid columns="4" cellpadding="5">
            <p:outputLabel for="txt" value="Text Value:" />
            <p:inputText id="txt" value="#{basicView.text}" />
            <p:commandButton value="Submit"/>
            <h:outputText value="#{basicView.text}" />
        </h:panelGrid>
    </p:fragment>
</h:form>

 -->